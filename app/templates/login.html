<html>
<head>
    <meta charset="UTF-8">
    <title>Sign In form</title>
    <link rel="stylesheet" type="text/css" href="../static/css/login.css">
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
	<style type="text/css">
	.x-axis path {
	    stroke:white;
	    fill:none;
	}
	.x-axis line {
	    fill: none;
	    stroke: none;
	    stroke-opacity:.8;
	    shape-rendering: crispEdges;
	}
	.bars rect {
	    fill:steelblue;
	    fill-opacity:.9;
	}
	.title {
	    font-weight: bold;
	}
	#precise-value {
	    fill:white;
	    font-size: 12px;
	}
</style>
</head>


<body>
<div id="main" class="container"> 
	
	<form class="login-form overlay wpl-track-me" name="loginform" id="loginform" action="" method="POST" >
		{{ sForm.hidden_tag() }}
        <p class="login-username">
            {{ sForm.email.label(for="user_login") }}
            {{ sForm.email(type="text", id="user_login", class="input", value="", size="20", placeholder="Email") }}
		</p>
		<p class="login-password">
            {{ sForm.password.label(for="user_pass") }}
            {{ sForm.password(type="password", id="user_pass", class="input", value="", size="20", placeholder="Password") }}
		</p> 
		<p class="login-remember">
			<label><input name="rememberme" type="checkbox" id="rememberme" value="forever"> Remember Me</label>
		</p> 
		<p class="login-submit">
            {{ sForm.submit(type="submit", id="wp-submit", class="button-primary", value="Login") }}
		</p>
		<p>
			<a class="login-forget" href="#" title="Password Lost and Found">Lost your password?</a>
		</p>
	</form> 
	<script type="text/javascript">

(function(){

    var margin = {top: 50, bottom: 50, left:250, right: 40};
    var width = 900 - margin.left - margin.right;
    var height = 450 - margin.top - margin.bottom;

    var xScale = d3.scale.linear().range([0, width]);
    var yScale = d3.scale.ordinal().rangeRoundBands([0, height], 1.8,0);

    var numTicks = 5;
    var xAxis = d3.svg.axis().scale(xScale)
                    .orient("top")
                    .tickSize((-height))
                    .ticks(numTicks);

    var svg = d3.select("body").append("svg")
                .attr("width", width+margin.left+margin.right)
                .attr("height", height+margin.top+margin.bottom)
                .attr("class", "base-svg");

    var barSvg = svg.append("g")
                .attr("transform", "translate("+margin.left+","+margin.top+")")
                .attr("class", "bar-svg");

    var x = barSvg.append("g")
            .attr("class", "x-axis");

    var url = "data.json";

    d3.json(url, function(data) {

        var xMax = d3.max(data, function(d) { return d.number; } );
        var xMin = 0;
        xScale.domain([xMin, xMax]);
        yScale.domain(data.map(function(d) { return d.category; }));

        d3.select(".base-svg").append("text")
            .attr("x", margin.left)
            .attr("y", (margin.top)/2)
            .attr("text-anchor", "start")
            .text("Narrowly defined unemployment numbers: top 20 countries (2010)")
            .attr("class", "title");

        var groups = barSvg.append("g").attr("class", "labels")
                    .selectAll("text")
                    .data(data)
                    .enter()
                    .append("g");

        groups.append("text")
                .attr("x", "0")
                .attr("y", function(d) { return yScale(d.category); })
                .text(function(d) { return d.category; })
                .attr("text-anchor", "end")
                .attr("dy", ".9em")
                .attr("dx", "-.32em")
                .attr("id", function(d,i) { return "label"+i; });

        var bars = groups
                    .attr("class", "bars")
                    .append("rect")
                    .attr("width", function(d) { return xScale(d.number); })
                    .attr("height", height/20)
                    .attr("x", xScale(xMin))
                    .attr("y", function(d) { return yScale(d.category); })
                    .attr("id", function(d,i) { return "bar"+i; });

        groups.append("text")
                .attr("x", function(d) { return xScale(d.number); })
                .attr("y", function(d) { return yScale(d.category); })
                .text(function(d) { return d.number; })
                .attr("text-anchor", "end")
                .attr("dy", "1.2em")
                .attr("dx", "-.32em")
                .attr("id", "precise-value");

        bars
            .on("mouseover", function() {
                var currentGroup = d3.select(this.parentNode);
                currentGroup.select("rect").style("fill", "brown");
                currentGroup.select("text").style("font-weight", "bold");
            })
            .on("mouseout", function() {
                var currentGroup = d3.select(this.parentNode);
                currentGroup.select("rect").style("fill", "steelblue");
                currentGroup.select("text").style("font-weight", "normal");
            });

        x.call(xAxis);
        var grid = xScale.ticks(numTicks);
        barSvg.append("g").attr("class", "grid")
            .selectAll("line")
            .data(grid, function(d) { return d; })
            .enter().append("line")
                .attr("y1", 0)
                .attr("y2", height+margin.bottom)
                .attr("x1", function(d) { return xScale(d); })
                .attr("x2", function(d) { return xScale(d); })
                .attr("stroke", "white");

    });

})();

</script>
 </div>
</body>
</html>